---
import Layout from '../layouts/Layout.astro';
import AuthGuard from '../components/AuthGuard.astro';
import StatsDashboard from '../components/StatsDashboard.astro';
import Calendar from '../components/Calendar.astro';
import ActivityModal from '../components/ActivityModal.astro';
import NavMenu from '../components/NavMenu.astro';
import StatisticsView from '../components/StatisticsView.astro'; // Will create next
---

<Layout title="Patagonia Tracker">
    <AuthGuard>
        <div class="app-container">
            <!-- HEADER -->
            <header class="app-header">
                <!-- NAV MENU (Left) -->
                <NavMenu />

                <!-- CENTER LOGO -->
                <div class="logo-area">
                    <div class="brand-title">
                        <span class="brand-main">PATAGONIA</span>
                        <span class="brand-orange">TRACKER</span>
                    </div>
                </div>
                
                <!-- Spacer for balance or tiny profile icon? -->
                <div style="width: 28px;"></div> 
            </header>
    
            <!-- VIEWS CONTAINER -->
            <div id="views-wrapper">
                
                <!-- VIEW: HOME -->
                <div id="view-home" class="view-section">
                    <StatsDashboard />
                    <main>
                        <Calendar />
                    </main>
                </div>

                <!-- VIEW: STATS -->
                <div id="view-stats" class="view-section hidden">
                    <StatisticsView />
                </div>

            </div>
            
            <ActivityModal />
        </div>
    </AuthGuard>
</Layout>

<script>
    import { currentView } from '../stores/uiStore';

    const vHome = document.getElementById('view-home');
    const vStats = document.getElementById('view-stats');

    currentView.subscribe(view => {
        // Simple Toggle
        if(view === 'home') {
            vHome.classList.remove('hidden');
            vStats.classList.add('hidden');
        } else if(view === 'stats') {
            vHome.classList.add('hidden');
            vStats.classList.remove('hidden');
        }
    });
</script>

<style>
    .app-container {
        max-width: 600px;
        margin: 0 auto;
        min-height: 100vh;
        background: var(--bg-main);
        box-shadow: 0 0 50px var(--shadow);
    }

    .app-header {
        display: flex; justify-content: space-between; align-items: center;
        padding: 15px 20px;
        background: var(--bg-main);
        position: sticky; top: 0; z-index: 50;
        border-bottom: 3px solid var(--bg-card);
    }

    .logo-area { display: flex; align-items: center; gap: 8px; text-align: center; }
    
    .brand-title { display: flex; flex-direction: column; line-height: 0.9; align-items: center; }
    .brand-main {
        font-family: var(--font-head); color: var(--text-main); font-size: 1.1rem; letter-spacing: 0.5px;
    }
    .brand-orange {
        font-family: var(--font-head); color: var(--primary); font-size: 1.1rem; letter-spacing: 0.5px;
    }

    .view-section {
        animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
</style>
